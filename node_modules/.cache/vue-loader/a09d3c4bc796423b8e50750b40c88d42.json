{"remainingRequest":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\src\\layouts\\HeaderAside\\components\\header-error-log\\components\\list\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\src\\layouts\\HeaderAside\\components\\header-error-log\\components\\list\\index.vue","mtime":1547717291702},{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1547717212861},{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1547717208828},{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1547717212861},{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1547717286390}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapState } from 'vuex'\r\nimport { get } from 'lodash'\r\nimport ExpandItem from './components/ExpandItem'\r\nexport default {\r\n  name: 'd2-error-log-list',\r\n  components: {\r\n    ExpandItem\r\n  },\r\n  computed: {\r\n    ...mapState('d2admin', {\r\n      logList: state => state.log.list\r\n    }),\r\n    logReverse () {\r\n      // 直接 reverse 的话有点问题\r\n      const res = []\r\n      const loglength = this.logList.length\r\n      this.logList.forEach((log, index) => {\r\n        res.push(this.logList[loglength - 1 - index])\r\n      })\r\n      return res\r\n    }\r\n  },\r\n  methods: {\r\n    get,\r\n    filterType (value, row) {\r\n      return row.type === value\r\n    },\r\n    stackBeautify (err) {\r\n      if (!err) {\r\n        return ''\r\n      }\r\n      return err.stack\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src\\layouts\\HeaderAside\\components\\header-error-log\\components\\list","sourcesContent":["<template>\r\n  <el-table\r\n    :data=\"logReverse\"\r\n    border\r\n    stripe\r\n    style=\"width: 100%\"\r\n    size=\"mini\">\r\n\r\n    <el-table-column type=\"expand\">\r\n      <div slot-scope=\"props\" class=\"d2-error-log-list__expand-group\">\r\n        <expand-item\r\n          :type=\"props.row.type\"\r\n          title=\"类型\"\r\n          :value=\"props.row.type === 'log' ? '日志' : '异常'\"/>\r\n        <expand-item\r\n          :type=\"props.row.type\"\r\n          title=\"内容\"\r\n          :value=\"props.row.info\"/>\r\n        <expand-item\r\n          v-if=\"props.row.type === 'error'\"\r\n          type=\"error\"\r\n          title=\"报错组件\"\r\n          :value=\"get(props.row.vm, '$vnode.tag', '')\"/>\r\n        <expand-item\r\n          v-if=\"props.row.type === 'error'\"\r\n          type=\"error\"\r\n          title=\"错误名称\"\r\n          :value=\"get(props.row.err, 'name', '')\"/>\r\n        <expand-item\r\n          v-if=\"props.row.type === 'error'\"\r\n          type=\"error\"\r\n          title=\"错误信息\"\r\n          :value=\"get(props.row.err, 'message', '')\"/>\r\n        <expand-item\r\n          v-if=\"props.row.type === 'error'\"\r\n          type=\"error\"\r\n          title=\"错误堆栈\"\r\n          value=\"见下\">\r\n          <div style=\"overflow: auto;\">\r\n            <pre>{{stackBeautify(props.row.err)}}</pre>\r\n          </div>\r\n        </expand-item>\r\n        <expand-item\r\n          :type=\"props.row.type\"\r\n          title=\"用户名\"\r\n          :value=\"get(props.row.user, 'name', '')\"/>\r\n        <expand-item\r\n          :type=\"props.row.type\"\r\n          title=\"uuid\"\r\n          :value=\"props.row.uuid\"/>\r\n        <expand-item\r\n          :type=\"props.row.type\"\r\n          title=\"token\"\r\n          :value=\"props.row.token\"/>\r\n        <expand-item\r\n          :type=\"props.row.type\"\r\n          title=\"页面地址\"\r\n          :value=\"props.row.url\"/>\r\n        <expand-item\r\n          :type=\"props.row.type\"\r\n          title=\"时间\"\r\n          :value=\"props.row.time\"/>\r\n      </div>\r\n    </el-table-column>\r\n\r\n    <el-table-column\r\n      prop=\"type\"\r\n      label=\"类型\"\r\n      width=\"80px\"\r\n      align=\"center\"\r\n      :filters=\"[\r\n        { text: '日志', value: 'log' },\r\n        { text: '异常', value: 'error' }\r\n      ]\"\r\n      :filter-multiple=\"false\"\r\n      :filter-method=\"filterType\"\r\n      filter-placement=\"bottom\">\r\n      <template slot-scope=\"scope\">\r\n        <el-tag\r\n          v-if=\"scope.row.type === 'error'\"\r\n          size=\"mini\"\r\n          type=\"danger\">\r\n          <d2-icon name=\"bug\"/> Bug\r\n        </el-tag>\r\n        <el-tag\r\n          v-else\r\n          size=\"mini\"\r\n          type=\"info\">\r\n          <d2-icon name=\"dot-circle-o\"/> Log\r\n        </el-tag>\r\n      </template>\r\n    </el-table-column>\r\n\r\n    <el-table-column\r\n      label=\"地址\"\r\n      prop=\"url\"\r\n      width=\"140px\"\r\n      :show-overflow-tooltip=\"true\">\r\n    </el-table-column>\r\n\r\n    <el-table-column\r\n      label=\"内容\"\r\n      prop=\"info\"\r\n      :show-overflow-tooltip=\"true\">\r\n    </el-table-column>\r\n\r\n    <el-table-column\r\n      label=\"错误类型\"\r\n      width=\"140px\"\r\n      :show-overflow-tooltip=\"true\">\r\n      <template\r\n        slot-scope=\"scope\">\r\n        {{get(scope.row.err, 'name', '')}}\r\n      </template>\r\n    </el-table-column>\r\n\r\n    <el-table-column\r\n      label=\"错误信息\"\r\n      width=\"300px\">\r\n      <template\r\n        slot-scope=\"scope\">\r\n        {{get(scope.row.err, 'message', '')}}\r\n      </template>\r\n    </el-table-column>\r\n\r\n  </el-table>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport { get } from 'lodash'\r\nimport ExpandItem from './components/ExpandItem'\r\nexport default {\r\n  name: 'd2-error-log-list',\r\n  components: {\r\n    ExpandItem\r\n  },\r\n  computed: {\r\n    ...mapState('d2admin', {\r\n      logList: state => state.log.list\r\n    }),\r\n    logReverse () {\r\n      // 直接 reverse 的话有点问题\r\n      const res = []\r\n      const loglength = this.logList.length\r\n      this.logList.forEach((log, index) => {\r\n        res.push(this.logList[loglength - 1 - index])\r\n      })\r\n      return res\r\n    }\r\n  },\r\n  methods: {\r\n    get,\r\n    filterType (value, row) {\r\n      return row.type === value\r\n    },\r\n    stackBeautify (err) {\r\n      if (!err) {\r\n        return ''\r\n      }\r\n      return err.stack\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import '~@/assets/style/public.scss';\r\n.d2-error-log-list__expand-group {\r\n  .d2-error-log-list__expand {\r\n    padding-left: 20px;\r\n    margin-bottom: 10px;\r\n    &:last-child {\r\n      margin-bottom: 0px;\r\n    }\r\n    .d2-error-log-list__expand-title {\r\n      font-size: 16px;\r\n      font-weight: bold;\r\n      margin-top: 0px;\r\n      margin-bottom: 10px;\r\n    }\r\n    .d2-error-log-list__expand-value {\r\n      font-size: 12px;\r\n      margin-top: 0px;\r\n      margin-bottom: 0px;\r\n    }\r\n  }\r\n  .d2-error-log-list__expand--log {\r\n    border-left: 4px solid $color-info;\r\n  }\r\n  .d2-error-log-list__expand--error {\r\n    border-left: 4px solid $color-danger;\r\n  }\r\n}\r\n</style>\r\n"]}]}