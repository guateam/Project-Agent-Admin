{"remainingRequest":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\babel-loader\\lib\\index.js!D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\src\\layouts\\HeaderAside\\components\\panel-search\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\src\\layouts\\HeaderAside\\components\\panel-search\\index.vue","mtime":1547717291760},{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1547717212861},{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1547717208828},{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1547717212861},{"path":"D:\\phpStudy\\PHPTutorial\\WWW\\Project-Agent-Admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1547717286390}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.search\";\nimport _objectSpread from \"D:\\\\phpStudy\\\\PHPTutorial\\\\WWW\\\\Project-Agent-Admin\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Fuse from 'fuse.js';\nimport { mapState } from 'vuex';\nimport mixin from '../mixin/menu';\nexport default {\n  mixins: [mixin],\n  components: {\n    'd2-panel-search-item': function d2PanelSearchItem() {\n      return import('./components/panel-search-item/index.vue');\n    }\n  },\n  data: function data() {\n    return {\n      searchText: '',\n      results: []\n    };\n  },\n  computed: _objectSpread({}, mapState('d2admin/search', ['hotkey', 'pool']), {\n    // 这份数据是展示在搜索面板下面的\n    resultsList: function resultsList() {\n      return this.results.length === 0 && this.searchText === '' ? this.pool.map(function (e) {\n        return _objectSpread({\n          value: e.fullTitle\n        }, e);\n      }) : this.results;\n    }\n  }),\n  methods: {\n    /**\r\n     * @description 过滤选项 这个方法在每次输入框的值发生变化时会触发\r\n     */\n    querySearch: function querySearch(queryString, callback) {\n      var pool = this.pool;\n      var results = this.query(queryString ? pool : [], queryString);\n      this.results = results;\n      callback(results);\n    },\n\n    /**\r\n     * @description 指定的数据源中根据指定的查询字符串过滤数据\r\n     * @param {Object} pool 需要过滤的数据\r\n     * @param {String} queryString 查询字符串\r\n     */\n    query: function query(pool, queryString) {\n      return new Fuse(pool, {\n        shouldSort: true,\n        tokenize: true,\n        threshold: 0.6,\n        location: 0,\n        distance: 100,\n        maxPatternLength: 32,\n        minMatchCharLength: 1,\n        keys: ['fullTitle', 'path']\n      }).search(queryString).map(function (e) {\n        return _objectSpread({\n          value: e.fullTitle\n        }, e);\n      });\n    },\n\n    /**\r\n     * @description 聚焦输入框\r\n     */\n    focus: function focus() {\n      var _this = this;\n\n      this.input = '';\n      setTimeout(function () {\n        _this.$refs.input.focus(); // 还原\n\n\n        _this.searchText = '';\n        _this.results = [];\n      }, 500);\n    },\n\n    /**\r\n     * @description 接收用户在列表中选择项目的事件\r\n     */\n    handleResultsGroupItemClick: function handleResultsGroupItemClick(path) {\n      // 如果用户选择的就是当前页面 就直接关闭搜索面板\n      if (path === this.$route.path) {\n        this.handleEsc();\n        return;\n      } // 用户选择的是其它页面\n\n\n      this.handleMenuSelect(path);\n    },\n\n    /**\r\n     * @description 接收用户在下拉菜单中选中事件\r\n     */\n    handleSelect: function handleSelect(_ref) {\n      var _this2 = this;\n\n      var path = _ref.path;\n\n      // 如果用户选择的就是当前页面 就直接关闭搜索面板\n      if (path === this.$route.path) {\n        this.handleEsc();\n        return;\n      } // 用户选择的是其它页面\n\n\n      this.$nextTick(function () {\n        _this2.handleMenuSelect(path);\n      });\n    },\n\n    /**\r\n     * @augments 关闭输入框的下拉菜单\r\n     */\n    closeSuggestion: function closeSuggestion() {\n      if (this.$refs.input.activated) {\n        this.$refs.input.suggestions = [];\n        this.$refs.input.activated = false;\n      }\n    },\n\n    /**\r\n     * @augments 接收用户点击空白区域的关闭\r\n     */\n    handlePanelClick: function handlePanelClick() {\n      this.handleEsc();\n    },\n\n    /**\r\n     * @augments 接收用户触发的关闭\r\n     */\n    handleEsc: function handleEsc() {\n      var _this3 = this;\n\n      this.closeSuggestion();\n      this.$nextTick(function () {\n        _this3.$emit('close');\n      });\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA,OAAA,IAAA,MAAA,SAAA;AACA,SAAA,QAAA,QAAA,MAAA;AACA,OAAA,KAAA,MAAA,eAAA;AACA,eAAA;AACA,EAAA,MAAA,EAAA,CACA,KADA,CADA;AAIA,EAAA,UAAA,EAAA;AACA,4BAAA;AAAA,aAAA,OAAA,0CAAA,CAAA;AAAA;AADA,GAJA;AAOA,EAAA,IAPA,kBAOA;AACA,WAAA;AACA,MAAA,UAAA,EAAA,EADA;AAEA,MAAA,OAAA,EAAA;AAFA,KAAA;AAIA,GAZA;AAaA,EAAA,QAAA,oBACA,QAAA,CAAA,gBAAA,EAAA,CACA,QADA,EAEA,MAFA,CAAA,CADA;AAKA;AACA,IAAA,WANA,yBAMA;AACA,aAAA,KAAA,OAAA,CAAA,MAAA,KAAA,CAAA,IAAA,KAAA,UAAA,KAAA,EAAA,GAAA,KAAA,IAAA,CAAA,GAAA,CAAA,UAAA,CAAA;AAAA;AACA,UAAA,KAAA,EAAA,CAAA,CAAA;AADA,WAEA,CAFA;AAAA,OAAA,CAAA,GAGA,KAAA,OAHA;AAIA;AAXA,IAbA;AA0BA,EAAA,OAAA,EAAA;AACA;;;AAGA,IAAA,WAJA,uBAIA,WAJA,EAIA,QAJA,EAIA;AACA,UAAA,IAAA,GAAA,KAAA,IAAA;AACA,UAAA,OAAA,GAAA,KAAA,KAAA,CAAA,WAAA,GAAA,IAAA,GAAA,EAAA,EAAA,WAAA,CAAA;AACA,WAAA,OAAA,GAAA,OAAA;AACA,MAAA,QAAA,CAAA,OAAA,CAAA;AACA,KATA;;AAUA;;;;;AAKA,IAAA,KAfA,iBAeA,IAfA,EAeA,WAfA,EAeA;AACA,aAAA,IAAA,IAAA,CAAA,IAAA,EAAA;AACA,QAAA,UAAA,EAAA,IADA;AAEA,QAAA,QAAA,EAAA,IAFA;AAGA,QAAA,SAAA,EAAA,GAHA;AAIA,QAAA,QAAA,EAAA,CAJA;AAKA,QAAA,QAAA,EAAA,GALA;AAMA,QAAA,gBAAA,EAAA,EANA;AAOA,QAAA,kBAAA,EAAA,CAPA;AAQA,QAAA,IAAA,EAAA,CACA,WADA,EAEA,MAFA;AARA,OAAA,EAaA,MAbA,CAaA,WAbA,EAcA,GAdA,CAcA,UAAA,CAAA;AAAA;AACA,UAAA,KAAA,EAAA,CAAA,CAAA;AADA,WAEA,CAFA;AAAA,OAdA,CAAA;AAkBA,KAlCA;;AAmCA;;;AAGA,IAAA,KAtCA,mBAsCA;AAAA;;AACA,WAAA,KAAA,GAAA,EAAA;AACA,MAAA,UAAA,CAAA,YAAA;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,KAAA,CAAA,KAAA,GADA,CAEA;;;AACA,QAAA,KAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,OAAA,GAAA,EAAA;AACA,OALA,EAKA,GALA,CAAA;AAMA,KA9CA;;AA+CA;;;AAGA,IAAA,2BAlDA,uCAkDA,IAlDA,EAkDA;AACA;AACA,UAAA,IAAA,KAAA,KAAA,MAAA,CAAA,IAAA,EAAA;AACA,aAAA,SAAA;AACA;AACA,OALA,CAMA;;;AACA,WAAA,gBAAA,CAAA,IAAA;AACA,KA1DA;;AA2DA;;;AAGA,IAAA,YA9DA,8BA8DA;AAAA;;AAAA,UAAA,IAAA,QAAA,IAAA;;AACA;AACA,UAAA,IAAA,KAAA,KAAA,MAAA,CAAA,IAAA,EAAA;AACA,aAAA,SAAA;AACA;AACA,OALA,CAMA;;;AACA,WAAA,SAAA,CAAA,YAAA;AACA,QAAA,MAAA,CAAA,gBAAA,CAAA,IAAA;AACA,OAFA;AAGA,KAxEA;;AAyEA;;;AAGA,IAAA,eA5EA,6BA4EA;AACA,UAAA,KAAA,KAAA,CAAA,KAAA,CAAA,SAAA,EAAA;AACA,aAAA,KAAA,CAAA,KAAA,CAAA,WAAA,GAAA,EAAA;AACA,aAAA,KAAA,CAAA,KAAA,CAAA,SAAA,GAAA,KAAA;AACA;AACA,KAjFA;;AAkFA;;;AAGA,IAAA,gBArFA,8BAqFA;AACA,WAAA,SAAA;AACA,KAvFA;;AAwFA;;;AAGA,IAAA,SA3FA,uBA2FA;AAAA;;AACA,WAAA,eAAA;AACA,WAAA,SAAA,CAAA,YAAA;AACA,QAAA,MAAA,CAAA,KAAA,CAAA,OAAA;AACA,OAFA;AAGA;AAhGA;AA1BA,CAAA","sourcesContent":["<template>\r\n  <div\r\n    class=\"panel-search\"\r\n    flex=\"dir:top\">\r\n    <div\r\n      class=\"panel-search__input-group\"\r\n      flex-box=\"0\"\r\n      flex=\"dir:top main:center cross:center\"\r\n      @click.self=\"handlePanelClick\">\r\n      <d2-icon-svg\r\n        class=\"panel-search__logo\"\r\n        name=\"d2-admin-text\"/>\r\n      <el-autocomplete\r\n        class=\"panel-search__input\"\r\n        ref=\"input\"\r\n        v-model=\"searchText\"\r\n        suffix-icon=\"el-icon-search\"\r\n        placeholder=\"搜索页面\"\r\n        :fetch-suggestions=\"querySearch\"\r\n        :trigger-on-focus=\"false\"\r\n        :clearable=\"true\"\r\n        @keydown.esc.native=\"handleEsc\"\r\n        @select=\"handleSelect\">\r\n        <d2-panel-search-item\r\n          slot-scope=\"{ item }\"\r\n          :item=\"item\"/>\r\n      </el-autocomplete>\r\n      <div class=\"panel-search__tip\">\r\n        您可以使用快捷键\r\n        <span class=\"panel-search__key\">{{hotkey.open}}</span>\r\n        唤醒搜索面板，按\r\n        <span class=\"panel-search__key\">{{hotkey.close}}</span>\r\n        关闭\r\n      </div>\r\n    </div>\r\n    <div\r\n      v-if=\"resultsList.length > 0\"\r\n      class=\"panel-search__results-group\"\r\n      flex-box=\"1\">\r\n      <el-card>\r\n        <div class=\"panel-search__results-group-inner\">\r\n          <d2-panel-search-item\r\n            v-for=\"(item, index) in resultsList\"\r\n            :key=\"index\"\r\n            :item=\"item\"\r\n            :hover-mode=\"true\"\r\n            @click.native=\"handleResultsGroupItemClick(item.path)\"/>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Fuse from 'fuse.js'\r\nimport { mapState } from 'vuex'\r\nimport mixin from '../mixin/menu'\r\nexport default {\r\n  mixins: [\r\n    mixin\r\n  ],\r\n  components: {\r\n    'd2-panel-search-item': () => import('./components/panel-search-item/index.vue')\r\n  },\r\n  data () {\r\n    return {\r\n      searchText: '',\r\n      results: []\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState('d2admin/search', [\r\n      'hotkey',\r\n      'pool'\r\n    ]),\r\n    // 这份数据是展示在搜索面板下面的\r\n    resultsList () {\r\n      return (this.results.length === 0 && this.searchText === '') ? this.pool.map(e => ({\r\n        value: e.fullTitle,\r\n        ...e\r\n      })) : this.results\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n     * @description 过滤选项 这个方法在每次输入框的值发生变化时会触发\r\n     */\r\n    querySearch (queryString, callback) {\r\n      var pool = this.pool\r\n      const results = this.query(queryString ? pool : [], queryString)\r\n      this.results = results\r\n      callback(results)\r\n    },\r\n    /**\r\n     * @description 指定的数据源中根据指定的查询字符串过滤数据\r\n     * @param {Object} pool 需要过滤的数据\r\n     * @param {String} queryString 查询字符串\r\n     */\r\n    query (pool, queryString) {\r\n      return new Fuse(pool, {\r\n        shouldSort: true,\r\n        tokenize: true,\r\n        threshold: 0.6,\r\n        location: 0,\r\n        distance: 100,\r\n        maxPatternLength: 32,\r\n        minMatchCharLength: 1,\r\n        keys: [\r\n          'fullTitle',\r\n          'path'\r\n        ]\r\n      })\r\n        .search(queryString)\r\n        .map(e => ({\r\n          value: e.fullTitle,\r\n          ...e\r\n        }))\r\n    },\r\n    /**\r\n     * @description 聚焦输入框\r\n     */\r\n    focus () {\r\n      this.input = ''\r\n      setTimeout(() => {\r\n        this.$refs.input.focus()\r\n        // 还原\r\n        this.searchText = ''\r\n        this.results = []\r\n      }, 500)\r\n    },\r\n    /**\r\n     * @description 接收用户在列表中选择项目的事件\r\n     */\r\n    handleResultsGroupItemClick (path) {\r\n      // 如果用户选择的就是当前页面 就直接关闭搜索面板\r\n      if (path === this.$route.path) {\r\n        this.handleEsc()\r\n        return\r\n      }\r\n      // 用户选择的是其它页面\r\n      this.handleMenuSelect(path)\r\n    },\r\n    /**\r\n     * @description 接收用户在下拉菜单中选中事件\r\n     */\r\n    handleSelect ({ path }) {\r\n      // 如果用户选择的就是当前页面 就直接关闭搜索面板\r\n      if (path === this.$route.path) {\r\n        this.handleEsc()\r\n        return\r\n      }\r\n      // 用户选择的是其它页面\r\n      this.$nextTick(() => {\r\n        this.handleMenuSelect(path)\r\n      })\r\n    },\r\n    /**\r\n     * @augments 关闭输入框的下拉菜单\r\n     */\r\n    closeSuggestion () {\r\n      if (this.$refs.input.activated) {\r\n        this.$refs.input.suggestions = []\r\n        this.$refs.input.activated = false\r\n      }\r\n    },\r\n    /**\r\n     * @augments 接收用户点击空白区域的关闭\r\n     */\r\n    handlePanelClick () {\r\n      this.handleEsc()\r\n    },\r\n    /**\r\n     * @augments 接收用户触发的关闭\r\n     */\r\n    handleEsc () {\r\n      this.closeSuggestion()\r\n      this.$nextTick(() => {\r\n        this.$emit('close')\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '~@/assets/style/public.scss';\r\n.panel-search {\r\n  margin: 20px;\r\n  .panel-search__input-group {\r\n    height: 240px;\r\n    .panel-search__logo {\r\n      width: 80px;\r\n      height: 80px;\r\n      margin-bottom: 20px;\r\n    }\r\n    .panel-search__input {\r\n      width: 500px;\r\n    }\r\n    .panel-search__tip {\r\n      @extend %unable-select;\r\n      margin-top: 20px;\r\n      margin-bottom: 40px;\r\n      font-size: 12px;\r\n      color: $color-text-sub;\r\n      .panel-search__key {\r\n        padding: 1px 5px;\r\n        margin: 0px 2px;\r\n        border-radius: 2px;\r\n        background-color: $color-text-normal;\r\n        color: $color-bg;\r\n      }\r\n    }\r\n  }\r\n  .panel-search__results-group {\r\n    overflow: auto;\r\n    .panel-search__results-group-inner {\r\n      margin: -20px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src\\layouts\\HeaderAside\\components\\panel-search"}]}